<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>我创建的收藏夹-素材站</title>
    <!--加载导航栏图标-->
    <link rel="shortcut icon" href="/public/ico/favicon.ico"/>
    <link rel="stylesheet" href="/public/css/member/information.css">
    <link rel="stylesheet" href="/public/layui/css/layui.css">
    <!--引入jquer-->
    <script type="text/javascript" src="/public/jquery.js"></script>
    <!--引入layer-->
    <script type="text/javascript" src="/public/layer/layer.js"></script>
    <script type="text/javascript" src="/public/js/member/information.js"></script>
    <!--引入layui-->
    <script type="text/javascript" src="/public/layui/layui.all.js"></script>
    <!--引入公共的js文件-->
    <script type="text/javascript" src="/public/js/member/common.js"></script>
    <!--引入公共的css文件-->
    <link rel="stylesheet" href="/public/css/member/common.css">
    <style>
        article .left .head{
            width:calc(100% - 30px);
            height:30px;
            padding:15px;
            line-height:30px;
            font-size:12pt;
            border-bottom:1px solid #EEEEEE;
        }
        article .left{
            background:#ffffff;
        }
        article .left .like{
            width:calc(100% - 30px);
            padding:15px;
        }
        article .left .like ul{
            width:100%;
            padding:0;
            margin:0;
        }
        article .left .like ul li{
            width:100%;
            height:60px;
            margin-bottom:15px;
            border-bottom:1px solid #EEEEEE;
            padding-bottom:15px;
        }
        article .left .like ul li .le{
            height:60px;
            width:80px;
            background:#DDDDDD;
            float:left;
        }
        article .left .like ul li .ri{
            height:60px;
            width:calc(100% - 90px);
            float:left;
            font-size:8pt;
            margin-left:10px;
        }
        article .left .like ul li .ri .h .lock{
            width:10px;
            height:10px;
            float:right;
            margin-right:20px;
        }
        article .left .like ul li .ri .h{
            width:100%;
            height:10px;
            line-height:10px;
        }
        article .left .like ul li .ri .d{
            width:100%;
            height:10px;
            margin-top:35px;
            color:#BBBBBB;
        }
        article .left .like ul li .ri .d .operate{
            height:10px;
            width:40px;
            float:right;
        }
        article .left .like ul li .ri .d .operate img{
            width:10px;
            height:10px;
            margin-right:10px;
            cursor: pointer;
            margin-top:5px;
        }
        article .left .like ul li .url{
            cursor: pointer;
        }
        .thisl{
            color:#13A38C;
        }
        .right .head{
            width:calc(100% - 30px);
            height:30px;
            line-height:30px;
            font-size:12pt;
            background:#ffffff;
            float:left;
            padding:15px;
            border-radius:3px;
        }
        .right .info{
            width:100%;
            min-height:90px;
            background:#ffffff;
            border-radius:3px;
        }
        .right .info .lef{
            width:620px;
            float:left;
            min-height:50px;
            padding:20px;
            border-right:1px solid #EEEEEE;
        }
        .right .info .lef .name{
            width:100%;
            height:30px;
            font-size:16pt;
            line-height:30px;
            font-family: '微软雅黑';
        }
        .right .info .lef .description{
            width:calc(100% - 40px);
            min-height:20px;
            padding:20px;
            padding-left:0px;
        }
        .right .info .rig{
            width:calc(100% - 702px);
            float:left;
            padding:20px;
            min-height:50px;
        }
        .right .info .rig .list .text{
            color:#BBBBBB;
        }
        .right .info .rig .list{
            width:100%;
            height:20px;
            line-height:20px;
        }
        .right .con{
            width:100%;
            min-height:500px;
        }
        .right .con ul{
            width:calc(100% + 20px);
            min-height:500px;
        }
        .right .con ul li{
            width:215px;
            height:310px;
            float:left;
            background:#ffffff;
            margin-right:20px;
            border-radius:3px;
            margin-bottom:20px;
        }
        .right .con ul li .litpic{
            width:100%;
            height:160px;
            background:#EEEEEE;
        }
        .right .con ul li .litpic img{
            width:100%;
            height:160px;
            border-radius:3px;
        }
        .right .con ul li .inf{
            width:calc(100% - 30px);
            height:70px;
            padding:15px;
            border-bottom:1px solid #EEEEEE;
        }
        .right .con ul li .inf .name{
            width:100%;
            height:20px;
            line-height:20px;
        }
        .right .con ul li .inf .column{
            width:100%;
            height:20px;
            font-size:10pt;
            line-height:20px;
            color:#BBBBBB;
        }
        .right .con ul li .inf .more{
            width:100%;
            height:30px;
            line-height:40px;
        }
        .right .con ul li .inf .more img{
            width:20px;
            height:20px;
            float:left;
            margin-top:10px;
        }
        .right .con ul li .inf .more .s{
            float:left;
            padding-right:10px;
            padding-left:5px;
            color:#BBBBBB;
        }
        .right .con ul li .user{
            width:calc(100% - 30px);
            height:30px;
            padding-left:15px;
            padding-right:15px;
            padding-top:10px;
            padding-bottom:10px;
            line-height:30px;
            font-size:8pt;
        }
        .right .con ul li .user .time{
            float:right;
        }
        .right .con ul li .delete{
            width:60px;
            height:20px;
            line-height:20px;
            color:#ffffff;
            background-color:rgba(0,0,0,.4);
            position: absolute;
            margin-top:-300px;
            z-index: 99;
            text-align:center;
            border-radius:3px;
            margin-left:145px;
            cursor:pointer;
            font-size:8pt;
        }
    </style>
</head>
<body>
{include file="templates/accounts/header" /}
<article>
    <div class="left inline">
        <div class="head">
            我创建的收藏夹（{$count}）
        </div>
        <div class="like">
            <ul>
                {volist name="$like_class_list" id="vo"}
                    <li class="l">
                        <div class="le url" data-id="{$vo.id}">
                            {volist name="$vo.litpic" id="v"}
                                <img src="{$v}" alt="" width="50%" height="50%" style="float:left">
                            {/volist}
                        </div>
                        <div class="ri">
                            <div data-id="{$vo.id}" class="h url {if $id eq $vo.id}thisl{/if}" >
                                {$vo.name}
                                {if $vo.type eq 1}
                                    <img src="/public/png/lock.png" alt="" class="lock">
                                {/if}
                            </div>
                            <div class="d">
                                <div style="float:left;">{$vo.num}个内容</div>
                                {if $vo.create_type eq 2}
                                    <div class="operate" data-id="{$vo.id}">
                                        <img src="/public/png/delete.png" alt="删除" data-type="delete" class="inline">
                                        <img src="/public/png/edit.png" alt="编辑" data-type="edit" class="inline">
                                    </div>
                                {/if}
                            </div>
                        </div>
                    </li>
                {/volist}
            </ul>
        </div>
    </div>
    <div class="right inline">
        <div class="head">
            收藏夹详情
            <a href="/member/information/mylike.html" style="float:right;color:red;">返回收藏夹列表</a>
        </div>
        <div style="clear:both;width:100%;height:1px;"></div>
        <div class="info">
            <div class="lef">
                <div class="name">
                    {$like_class_info.name}
                    {if $vo.type eq 1}
                        <img src="/public/png/lock.png" alt="" class="lock" style="width:25px;height:25px;margin-top:-5px;">
                    {/if}
                </div>
                {if $like_class_info.create_type eq 2}
                    <div class="description">
                        {$like_class_info.description}
                    </div>
                {/if}
            </div>
            <div class="rig">
                <div class="list">
                    <div class="inline">创建时间：</div>
                    <div class="inline text">
                        {if $like_class_info.create_type eq 1}
                            由系统创建
                        {else /}
                            {$like_class_info.create_time}
                        {/if}
                    </div>
                </div>
                {if $like_class_info.create_type eq 2}
                    <div class="list">
                        <div class="inline">更新时间：</div>
                        <div class="inline text">
                            {$like_class_info.alter_time}
                        </div>
                    </div>
                {/if}
                <div class="list">
                    <div class="inline">内容数量：</div>
                    <div class="inline text">
                        {$like_class_info.num}
                    </div>
                </div>
                {if $like_class_info.create_type eq 2}
                    <div class="list">
                        <div class="inline">关注人数：</div>
                        <div class="inline text">
                            {$like_class_info.praise}
                        </div>
                    </div>
                {/if}
            </div>
            <div style="clear:both;width:100%;height:1px;"></div>
        </div>
        <div style="width:100%;height:20px;padding-top:15px;padding-bottom:15px;line-height:20px;">共{$like_class_info.num}个作品</div>
        <div class="con" {if $like_class_info.num == 0}style="background:url(/public/png/empty-msg.png) center no-repeat;background-color:#ffffff;"{/if}>
            <ul>
                {volist name="$like_list" id="vo"}
                    <li data-id="{$vo.id}">
                        <a href="{$vo.article_info.url}" target="_blank" data-column="{$vo.article_info.column_id}">
                            <div class="litpic">
                                <img src="{$vo.article_info.litpic}" alt="">
                            </div>
                        </a>
                        <div class="inf">
                            <a href="{$vo.article_info.url}" target="_blank" data-column="{$vo.article_info.column_id}">
                                <div class="name">
                                    {$vo.article_info.title|cut_str=###,12}
                                </div>
                            </a>
                            <div class="column">
                                {$vo.column_info.type_name}
                            </div>
                            <div class="more">
                                <img src="/public/png/browse.png" alt="浏览{$vo.article_info.click}次"><div class="s">{$vo.article_info.click}</div>
                                <img src="/public/png/comment.png" alt="评论{$vo.article_info.comment_num}条"><div class="s">{$vo.article_info.comment_num}</div>
                                <img src="/public/png/praise.png" alt=""><div class="s">0</div>
                            </div>
                        </div>
                        <div class="user">
                            <img src="{$vo.user_info.face}" alt="" style="width:20px;height:20px;border-radius:10px;margin-top:-5px;">
                            {$vo.user_info.nickname}
                            <div class="time">时间：{$vo.create_time|date='Y-m-d',###}</div>
                        </div>
                        <div class="delete">X 移除</div>
                    </li>
                {/volist}
            </ul>
            <div style="width:100%;height:1px;clear: both"></div>
        </div>
        {if $like_class_info.num neq 0}
            <div class="padding" style="width:100%;height:30px;">
                {$page}
            </div>
        {/if}
        <div style="width:100%;height:1px;clear: both"></div>
    </div>
    <div style="width:100%;height:1px;clear: both"></div>
</article>
{include file="templates/accounts/footer" /}
</body>
<script>
    $('.operate').hide();
    $('.delete').hide();
    $(function(){
        //绑定跳转链接事件
        $('.url').on('click' ,function () {
            var id = this.dataset.id;
            window.location.href = '/member/information/showlikeclass.html?id='+id;
        });
        $('.l').hover(function () {
            $(this).children('.ri').children('.d').children('.operate').show();
        },function () {
            $(this).children('.ri').children('.d').children('.operate').hide();
        });
        //绑定操作区内图片点击事件
        $('.operate img').on('click' ,function () {
            var type = this.dataset.type;
            var id = $(this).parent('.operate')[0].dataset.id;
            var that = $(this);
            if(type == 'delete'){
                layer.confirm('确定要删除此收藏夹吗？',{
                    btn: ['确定', '取消'] //按钮
                }, function () {
                    //发送ajax请求
                    $.ajax({
                        url:'/member/information/dellikeclass.html',
                        type:'post',
                        data:{id:id},
                        beforeSend: function () {
                            loading = layer.load(0, {shade: false});
                        },
                        success: function (e) {
                            var data = JSON.parse(e);
                            layer.close(loading);
                            layer.msg(data.msg ,{time:2000} ,function () {
                                that.parent().parent().parent().parent('li').hide();
                                layer.closeAll();
                            });
                        }
                    })
                }, function () {
                    //关闭 layer弹出层
                    layer.closeAll();
                });
            }else if(type == 'edit'){
                layer.open({
                    type: 2,
                    title: '编辑收藏夹',
                    shadeClose: true,
                    shade: 0.8,
                    area: ['510px', '370px'],
                    content: '/member/information/editlikeclass.html?id=' + id //iframe的url
                });
            }
        });
        //绑定收藏夹内文档列表a链接跳转事件
        $('.con a').on('click' ,function () {
            var href = $(this)[0].href;
            var column = this.dataset.column;
            //发送ajax请求，获取所属栏目的父级栏目id
            $.ajax({
                url:'/member/information/getparentcolumn.html',
                type:'post',
                data:{column:column},
                async:true,
                success:function (e) {
                    var res = JSON.parse(e);
                    if(res.errorcode == 0){
                        if(res.data == 54){
                            layer.msg('手机相关文档暂时不支持在电脑上查看' ,{time:2000});
                        }else{
                            window.open(href ,'_blank');
                        }
                    }
                }
            });
            return false;
        });
        //绑定收藏内容列表鼠标放上去事件
        $.each($('.con ul').children('li') ,function () {
            $(this).hover(function () {
                $(this).children('.delete').show();
            },function () {
                $(this).children('.delete').hide();
            })
        });
        //绑定移除按钮事件
        $('.delete').on('click' ,function () {
            var id = $(this).parent()[0].dataset.id;
            var that = $(this);
            //发送ajax请求
            $.ajax({
                url:'/member/information/dellikecontent.html',
                type:'post',
                data:{id:id},
                beforeSend: function () {
                    loading = layer.load(0, {shade: false});
                },
                success: function (e) {
                    var data = JSON.parse(e);
                    layer.close(loading);
                    layer.msg(data.msg ,{time:2000} ,function () {
                        if(data.errorcode == 0){
                            that.parent().hide();
                        }
                    });
                }
            })
        });
    });
</script>
</html>